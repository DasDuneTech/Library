<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>

*{

    box-sizing: border-box;
    margin: 0;
    padding:0;

}

ul, #myUL {
  list-style-type: none;
  margin-left: 5px; 

}

li{

margin-left: 5px;

}

#myUL {
  margin: 0;
  padding: 0;
}

.caret {
  cursor: pointer;
  user-select: none;
}

.caret::before {
  content: "\25B6";
  color: black;
  display: inline-block;
  margin-right: 3px;
}

.caret-down::before {
  transform: rotate(90deg);  
}

.nested {
  display: none;
}

.active {
  display: block;
}

.push10{

    padding-left: 10px;


}
</style>
</head>
<body>

<button id="button">Click</button>

<br>

<br>


<ul id="myUL">
  <li><span id="Books-Sheets2" class="caret">Books-Sheets</span>
    <ul class="nested">
      <li><span id="Book1" class="caret">Book1</span>
        <ul class="nested">
          <li><span class="caret">Sheet1</span>
            <ul class="nested push10">
              <li>Tag1</li>
              <li>Tag2</li>
              <li>Tag3</li>
            </ul>
          </li>
          <li><span class="caret">Sheet2</span>
            <ul class="nested push10">
              <li>Tag4</li>
              <li>Tag5</li>
              <li>Tag6</li>
            </ul>
          </li>
          <li><span id="Sheet3" class="caret">Sheet3</span>
            <ul class="nested push10">
              <li>Tag6</li>
              <li id="Book1-Sheet3-Tag7">Tag7</li>
              <li>Tag8</li>
            </ul>
          </li>
        </ul>
      </li> 
      <li><span id="Book1" class="caret">Book1</span>
        <ul class="nested">
          <li><span class="caret">Sheet1</span>
            <ul class="nested push10">
              <li>Tag1</li>
              <li>Tag2</li>
              <li>Tag3</li>
            </ul>
          </li>
          <li><span class="caret">Sheet2</span>
            <ul class="nested push10">
              <li>Tag4</li>
              <li>Tag5</li>
              <li>Tag6</li>
            </ul>
          </li>
          <li><span id="Sheet3" class="caret">Sheet3</span>
            <ul class="nested push10">
              <li>Tag6</li>
              <li id="Book1-Sheet3-Tag7">Tag7</li>
              <li>Tag8</li>
            </ul>
          </li>
        </ul>
      </li> 
      

    </ul>


    
  </li>




  
</ul>

<script>

popEle = (info) =>{

const {e, i, c, t, p} = info

  let ele = document.createElement(e)
  if (i !== undefined) ele.id = i
  if (c !== undefined) ele.className = c
  if (t !== undefined) ele.textContent = t
  p.appendChild(ele)
  return ele

}


toggle = (e) => {
    e.target.parentElement.querySelector(".nested").classList.toggle("active");
    e.target.classList.toggle("caret-down");
}

toggle2 = (ele) => {
    ele.parentElement.querySelector(".nested").classList.toggle("active");
    ele.classList.toggle("caret-down");
}


//root 
let ele = popEle({e:`ul`, i:`myUL2`, p:document.body})
ele = popEle({e: `li`, i:`Books-Sheets-Tags`, p:ele})
popEle({e: `span`, c:`caret`, t: `Books-Sheets-Tags`, p:ele})
ele = popEle({e: `ul`, i:`Books-Sheets`, c:`nested`, p:ele})

//level 0

let booksheetstags = [{book:`Book5`, sheet:`Sheet9`}, {book:`Book5`, sheet:`Sheet99`}, {book:`Book55`, sheet:`Sheet99`}, {book:`Book55`, sheet:`Sheet69`} ]

booksheetstags.map((item, i) => {

  if (document.getElementById(item.book) === null) {

    //level 1
    ele = document.getElementById(`Books-Sheets`)
    // ele = popEle({e: `ul`, c:`nested`, p:ele})
    ele = popEle({e: `li`, p:ele})
    popEle({e: `span`, c:`caret`, t: item.book, p:ele})

    //level 2
    ele = popEle({e: `ul`, c:`nested`, p:ele})
    ele = popEle({e: `li`, i:item.book, p:ele})
    ele = popEle({e: `span`, i:`${item.book}-${item.sheet}`, c:`caret`, t: item.sheet, p:ele})

  }

  else {

    //level 2
    ele = document.getElementById(`${item.book}`)
    popEle({e: `li`, i:`${item.book}-${item.sheet}`, p:ele})
    popEle({e: `span`, c:`caret`, t: item.sheet, p:ele})

  }





})

// ele = popEle({e: `li`, p:ele})
// popEle({e: `span`, i:`Books-Sheets-Tags`, c:`caret`, t: `Books-Sheets-Tags`, p:ele})

// //level 1
// ele = popEle({e: `ul`, c:`nested`, p:ele})
// ele = popEle({e: `li`, p:ele})
// popEle({e: `span`, i:`Book1`, c:`caret`, t: `Book1`, p:ele})

// //level 2
// ele = popEle({e: `ul`, c:`nested`, p:ele})
// ele = popEle({e: `li`, p:ele})
// popEle({e: `span`, i:`Sheet1`, c:`caret`, t: `Sheet1`, p:ele})

// //level 3
// ele = popEle({e: `ul`, c:`nested`, p:ele})
// ele = popEle({e: `li`, p:ele})
// popEle({e: `span`, i:`Tag1`, t: `Tag1`, p:ele})

// popEle({e: `li`, p:ele})
// popEle({e: `span`, i:`Tag2`, t: `Tag2`, p:ele})




Array.from(document.getElementsByClassName("caret")).map((item) => {
    console.log(item)
    item.addEventListener("click", (e) => toggle(e))
})










// let bookSheets = document.getElementById("Books-Sheets")
// let book1 = document.getElementById("Book1")
// let sheet3 = document.getElementById("Sheet3")
// let book1Sheet3Tag7 = document.getElementById("Book1-Sheet3-Tag7")

// document.getElementById("button").addEventListener("click", (e) => {
//     toggle2(bookSheets)
//     toggle2(book1)
//     toggle2(sheet3)
//     book1Sheet3Tag7.style.color = "blue"
//     })




let tags = `@Library.xlsx¶4BF5108ECD128AC3!4389~Sheet1&§Name§Tag1§Tag2§Tag3§Tag4§Tag5§Tag6§Tag7§Tag8§Tag9§~Sheet2&§Name§Tag11§Tag12§Tag13§Tag14§Tag15§Tag16§Tag17§Tag18§Tag19§Tag20§~Sheet3&§Name§Tag21§Tag22§Tag23§Tag24§Tag25§Tag26§Tag27§Tag28§Tag29§Tag30§@Library3.xlsx¶4BF5108ECD128AC3!4387~Sheet1&§Name§Tag301§Tag302§Tag303§Tag304§Tag305§Tag306§Tag307§Tag308§~Sheet2&§Name§Tag311§Tag312§Tag313§Tag314§Tag315§Tag316§Tag317§Tag318§~Sheet3&§Name§Tag331§Tag332§Tag333§Tag334§Tag335§Tag336§Tag337§Tag338§@Library2.xlsx¶4BF5108ECD128AC3!4388~Sheet1&§Name§Tag201§Tag202§Tag203§Tag204§Tag205§Tag206§Tag207§Tag208§~Sheet2&§Name§Tag211§Tag212§Tag213§Tag214§Tag215§Tag216§Tag217§Tag218§~Sheet3&§Name§Tag221§Tag222§Tag223§Tag224§Tag225§Tag226§Tag227§Tag228§`

let booksheetsTags = tags.match(/[^@]*/g)

booksheetsTags.forEach((bookSheetsTags) => {

if (bookSheetsTags !== '') {
    
    let sheetsTags = bookSheetsTags.match(/[^~^&]*/g)

    for (let sheetTags of sheetsTags) {

      //skip if a null
      if (sheetTags === '') continue
      //check if a book

      if (sheetTags.split('¶').length > 1) {
        bookName = sheetTags.split('¶')[0]
        console.log(bookName)
        continue
      }

      //check if a sheet
      if (sheetTags.match(/[^§]+/g).length <= 1) {
        sheetName = sheetTags
        console.log(sheetName)
        continue
    }

      //check if tags
      if (sheetTags.match(/[§]*/g).length !== 0) {
        tags = sheetTags.match(/[^§]*/g)
        console.log(tags)
      }

    }
}

popTreeHeader = () => {




}


})



</script>

</body>
</html>
